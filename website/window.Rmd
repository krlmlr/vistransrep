---
title: "Window functions"
author: "Kirill MÃ¼ller"
output: html_document
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(nycflights13)
knitr::opts_chunk$set(cache = TRUE)
```

## Busiest month

```{r window-1}
monthly_shares <-
  flights %>%
  group_by(carrier, month) %>%
  summarize(distance = sum(distance)) %>%
  mutate(total_distance = sum(distance)) %>%
  ungroup() %>%
  mutate(month_share = distance / total_distance) %>%
  arrange(-total_distance)

monthly_shares
```

```{r window-1-a}
monthly_shares %>% 
  ggplot(aes(factor(month), carrier, fill = month_share)) +
  geom_tile() +
  scale_fill_continuous(trans = "log10")
```
