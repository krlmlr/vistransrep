```{r 13-remove-all, include = FALSE}
rm(list = ls())
```


## Labels and layers

<details><summary>*Click here to show setup code.*</summary>
```{r include = FALSE}
### Labels and layers

```
```{r 13-setup-13-other-r}
library(tidyverse)
```
</details>

For character variables there is further way of integrating its value to a plot.
`geom_text()` takes a parameter `label`, which influences the plot in the following way.

```{r include = FALSE}
# geom_text()
```
```{r 13-geom-text}
ggplot(
  data = mpg,
  mapping = aes(x = displ, y = hwy)
) +
  geom_text(label = "A")
```

Let's try to map this parameter to a variable (here: `drv`) of our dataset in the `mapping` parameter of `ggplot()`.

```{r include = FALSE}
# set label in aes() for geom_text()
```
```{r 13-set-label-in-aes-for-geom-text}
ggplot(
  data = mpg,
  mapping = aes(x = displ, y = hwy, label = "drv")
) +
  geom_text()
```

Right, of course we need to pass the variable without quotation marks, otherwise it is interpreted as a (constant) character variable.
When changing this, a vector with the values of the variable is passed on to `geom_text()`.
This is one way of including the values of character variables in a plot.

```{r include = FALSE}
# 3rd aesthetic as label for geom_text()
```
```{r 13-3-rd-aesthetic-as-label-for-geom-text}
ggplot(
  data = mpg,
  mapping = aes(x = displ, y = hwy, label = drv)
) +
  geom_text()
```

By adding more than one `geom()`-function, more than one geometry is added to the plot.

```{r include = FALSE}
# Two layers
```
```{r 13-two-layers}
ggplot(
  data = mpg,
  mapping = aes(x = displ, y = hwy, label = drv)
) +
  geom_point() +
  geom_text()
```

Since this looks just slightly odd, let's try to make it more apparent, what is happening.

```{r include = FALSE}
# Two layers more clearly
```
```{r 13-two-layers-more-clearly}
ggplot(
  data = mpg,
  mapping = aes(x = displ, y = hwy, label = drv)
) +
  geom_point(color = "blue") +
  geom_text(size = 10)
```

It is also possible ot specify the mapping in the `geom()`-function.
This way, when adding more than one geometry, you can chose different specifications for the mapping in each of the `geom()`-functions.

```{r include = FALSE}
# Global and local aesthetic mappings
```
```{r 13-global-and-local-aesthetic-mappings}
ggplot(
  data = mpg,
  mapping = aes(x = displ, y = hwy)
) +
  geom_point(color = "blue") +
  geom_text(
    mapping = aes(color = class, label = drv),
    size = 10,
    alpha = 0.2
  )
```

This can be dangerous sometimes though.
A good approach is always to define the mapping globally in `ggplot()` when possible.

```{r include = FALSE}
# Good:
```
```{r 13-good}
ggplot(
  data = mpg,
  mapping = aes(x = displ, y = hwy)
) +
  geom_point() +
  geom_rug()
```

This would be redundant:

```{r include = FALSE}
# Bad:
```
```{r 13-bad}
ggplot(
  data = mpg
) +
  geom_point(mapping = aes(x = displ, y = hwy)) +
  geom_rug(mapping = aes(x = displ, y = hwy))
```

And here we have a mismatch between the two geometries, since the y-mapping is referring to different variables of the dataset.

```{r include = FALSE}
# Broken:
```
```{r 13-broken}
ggplot(
  data = mpg
) +
  geom_point(mapping = aes(x = displ, y = hwy)) +
  geom_rug(mapping = aes(x = displ, y = cty))
```

Displaying a scatter plot with an overlaid smooth curve fitted to the data is made very easy by the geometry function `geom_smooth()`

```{r include = FALSE}
# Smooth
```
```{r 13-smooth}
ggplot(
  data = mpg,
  mapping = aes(x = displ, y = hwy)
) +
  geom_point() +
  geom_smooth()
```

The default for the smoothing method is set to `auto`, which translates to a LOESS (locally estimated scatterplot smoothing) method, when dealing with fewer than 1000 observations.
Changing the method to "lm", a linear model will be fitted and displayed in your plot.

```{r include = FALSE}
# smooth method linear model
```
```{r 13-smooth-method-linear-model}
ggplot(
  data = mpg,
  mapping = aes(x = displ, y = hwy)
) +
  geom_point() +
  geom_smooth(method = "lm")
```
