```{r 51-remove-all, include = FALSE}
rm(list = ls())
```


## Plotting: custom labels and scales

<details><summary>*Click here to show setup code.*</summary>
```{r include = FALSE}
### Plotting: custom labels and scales

```
```{r 51-setup-51-scales-r}
library(tidyverse)
library(nycflights13)

library(conflicted)
conflict_prefer("filter", "dplyr")
conflict_prefer("lag", "dplyr")
```
</details>

In this section we want to spend some time getting to know how to customize the labels and scales of plots using {ggplot2}.
We start with a pretty basic plot using the `mpg`-tibble which comes with the {tidyverse}.

```{r include = FALSE}
# Base plot
```
```{r 51-base-plot}
ggplot(
  data = mpg,
  mapping = aes(x = displ, y = hwy, color = class)
) +
  geom_point()
```

With `ggplot2::labs()` you can label all sorts of aesthetics (axes, color mapping, ...). 
Additionally you can set the title/subtitle and also add a caption and a tag.

```{r include = FALSE}
# Add descriptive labels: the labs() function
```
```{r 51-add-descriptive-labels-the-labs-function}
ggplot(
  data = mpg,
  mapping = aes(x = displ, y = hwy, color = class)
) +
  geom_point() +
  labs(
    x = "Displacement",
    y = "Highway mileage\n[miles per gallon]",
    color = "Car class",
    title = "Highway mileages depending on displacement",
    subtitle = "By car class"
  )
```

There is a plethora of `scale_...()` functions available in {ggplot2}, which influence the axes.
For example there is a function to change the scale of an axis to a logarithmic scale.

```{r include = FALSE}
# Change scale to log scale
```
```{r 51-change-scale-to-log-scale}
ggplot(
  data = mpg,
  mapping = aes(x = displ, y = hwy, color = class)
) +
  geom_point() +
  scale_x_log10()
```

Be careful: you can set the name of an axis in both the `labs()` function and the `scale_...()` functions.
If you do both, only the name set in the latter will prevail.

```{r include = FALSE}
# Name in scale_() overwrites labs() without warning!
```
```{r 51-name-in-scale-overwrites-labs-without-warning}
ggplot(
  data = mpg,
  mapping = aes(x = displ, y = hwy, color = class)
) +
  geom_point() +
  labs(
    x = "Displacement"
  ) +
  scale_x_log10(name = "xxx")
```

Produce a double logarithmic plot by additionally turning the y-axis to a log scale.

```{r include = FALSE}
# Double log scale
```
```{r 51-double-log-scale}
ggplot(
  data = mpg,
  mapping = aes(x = displ, y = hwy, color = class)
) +
  geom_point() +
  scale_x_log10() +
  scale_y_log10()
```

Another type `scale_...()`-type function relates to the color-aesthetic.
These functions affect the palette that is used for the color mapping.
One of these is `scale_color_brewer()`:

```{r include = FALSE}
# Change color palette
```
```{r 51-change-color-palette}
ggplot(
  data = mpg,
  mapping = aes(x = displ, y = hwy, color = class)
) +
  geom_point() +
  scale_color_brewer(type = "qual")
```

Another option to change the "color theme" is `scale_color_viridis_d()` ("d" for discrete):

```{r include = FALSE}
# Other options: viridis
```
```{r 51-other-options-viridis}
ggplot(
  data = mpg,
  mapping = aes(x = displ, y = hwy, color = class)
) +
  geom_point() +
  scale_color_viridis_d(option = "B")
```

...or take full control of the colors yourself using `scale_color_manual()`

```{r include = FALSE}
# Full control: manual scale FIXME
```
```{r 51-full-control-manual-scale-fixme}
ggplot(
  data = mpg,
  mapping = aes(x = displ, y = hwy, color = class)
) +
  geom_point() +
  scale_color_manual(values = c(
    "2seater" = "#000000",
    "compact" = "#3355FF",
    "midsize" = "#006400",
    "minivan" = "#FF5522",
    "pickup" = "#66FFFF",
    "subcompact" = "#FF0000",
    "suv" = "#FF55FF"))
```


```{r include = FALSE}
# For "corporate design": ggthemr, https://github.com/cttobin/ggthemr
```
```{r 51-for-corporate-design-ggthemr-https-github-com-cttobin-ggthemr}
NA
```
